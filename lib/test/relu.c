#include "test/relu.h"

#include "test/util.h"
#include "test/assert.h"
#include "matutil.h"

int relu_random_1()
{
    int size = 10;

    float inputs[] = {0.0997, 0.122, 0.166, 0.545, 0.804, 0.722, 0.344, 1.0, 0.643, 0.754};
    float expected[] = {0.0997, 0.122, 0.166, 0.545, 0.804, 0.722, 0.344, 1.0, 0.643, 0.754};

    float ret[] = {0.0997, 0.122, 0.166, 0.545, 0.804, 0.722, 0.344, 1.0, 0.643, 0.754};
    matutil_relu(ret, 1, size);
    return print_result("ReLu random 1", assert_similarity(ret, expected, size));
}

int relu_random_2()
{
    int size = 10;

    float inputs[] = {0.433, 0.891, 0.167, 0.904, 0.556, 0.886, 0.125, 0.711, 0.161, 0.625};
    float expected[] = {0.433, 0.891, 0.167, 0.904, 0.556, 0.886, 0.125, 0.711, 0.161, 0.625};

    float ret[] = {0.433, 0.891, 0.167, 0.904, 0.556, 0.886, 0.125, 0.711, 0.161, 0.625};
    matutil_relu(ret, 1, size);
    return print_result("ReLu random 2", assert_similarity(ret, expected, size));
}

int relu_random_3()
{
    int size = 100;

    float inputs[] = {0.495, 0.97, 0.258, 0.0251, 0.725, 0.385, 0.623, 0.615, 0.424, 0.511, 0.7, 0.168, 0.141, 0.194, 0.798, 0.0414, 0.339, 0.932, 0.946, 0.581, 0.723, 0.361, 0.0348, 0.106, 0.305, 0.729, 0.239, 0.472, 0.427, 0.754, 0.0774, 0.926, 0.799, 0.998, 0.887, 0.885, 0.163, 0.429, 0.429, 0.0941, 0.862, 0.38, 0.164, 0.617, 0.537, 0.688, 0.169, 0.963, 0.11, 0.944, 0.138, 0.614, 0.817, 0.758, 0.211, 0.762, 0.921, 0.0983, 0.262, 0.671, 0.195, 0.962, 0.227, 0.457, 0.0527, 0.185, 0.565, 0.197, 0.2, 0.155, 0.279, 0.0125, 0.524, 0.445, 0.212, 0.732, 0.346, 0.736, 0.432, 0.351, 0.95, 0.157, 0.805, 0.707, 0.0577, 0.009, 0.469, 0.369, 0.12, 0.664, 0.332, 0.579, 0.943, 0.432, 0.87, 0.822, 0.368, 0.506, 0.875, 0.918};
    float expected[] = {0.495, 0.97, 0.258, 0.0251, 0.725, 0.385, 0.623, 0.615, 0.424, 0.511, 0.7, 0.168, 0.141, 0.194, 0.798, 0.0414, 0.339, 0.932, 0.946, 0.581, 0.723, 0.361, 0.0348, 0.106, 0.305, 0.729, 0.239, 0.472, 0.427, 0.754, 0.0774, 0.926, 0.799, 0.998, 0.887, 0.885, 0.163, 0.429, 0.429, 0.0941, 0.862, 0.38, 0.164, 0.617, 0.537, 0.688, 0.169, 0.963, 0.11, 0.944, 0.138, 0.614, 0.817, 0.758, 0.211, 0.762, 0.921, 0.0983, 0.262, 0.671, 0.195, 0.962, 0.227, 0.457, 0.0527, 0.185, 0.565, 0.197, 0.2, 0.155, 0.279, 0.0125, 0.524, 0.445, 0.212, 0.732, 0.346, 0.736, 0.432, 0.351, 0.95, 0.157, 0.805, 0.707, 0.0577, 0.009, 0.469, 0.369, 0.12, 0.664, 0.332, 0.579, 0.943, 0.432, 0.87, 0.822, 0.368, 0.506, 0.875, 0.918};

    float ret[] = {0.495, 0.97, 0.258, 0.0251, 0.725, 0.385, 0.623, 0.615, 0.424, 0.511, 0.7, 0.168, 0.141, 0.194, 0.798, 0.0414, 0.339, 0.932, 0.946, 0.581, 0.723, 0.361, 0.0348, 0.106, 0.305, 0.729, 0.239, 0.472, 0.427, 0.754, 0.0774, 0.926, 0.799, 0.998, 0.887, 0.885, 0.163, 0.429, 0.429, 0.0941, 0.862, 0.38, 0.164, 0.617, 0.537, 0.688, 0.169, 0.963, 0.11, 0.944, 0.138, 0.614, 0.817, 0.758, 0.211, 0.762, 0.921, 0.0983, 0.262, 0.671, 0.195, 0.962, 0.227, 0.457, 0.0527, 0.185, 0.565, 0.197, 0.2, 0.155, 0.279, 0.0125, 0.524, 0.445, 0.212, 0.732, 0.346, 0.736, 0.432, 0.351, 0.95, 0.157, 0.805, 0.707, 0.0577, 0.009, 0.469, 0.369, 0.12, 0.664, 0.332, 0.579, 0.943, 0.432, 0.87, 0.822, 0.368, 0.506, 0.875, 0.918};
    matutil_relu(ret, 1, size);
    return print_result("ReLu random 3", assert_similarity(ret, expected, size));
}

void test_relu(int *correct_cases, int *total_cases)
{
    *correct_cases += relu_random_1();
    *total_cases += 1;
    *correct_cases += relu_random_2();
    *total_cases += 1;
    *correct_cases += relu_random_3();
    *total_cases += 1;
}