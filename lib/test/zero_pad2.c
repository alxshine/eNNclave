#include "test/zero_pad2.h"

#include "test/util.h"
#include "test/assert.h"
#include "matutil.h"

int zero_pad2_random_1()
{
    int h = 3;
    int w = 3;
    int channels = 3;
    int top_pad = 1;
    int bottom_pad = 1;
    int left_pad = 1;
    int right_pad = 1;

    float inputs[] = {0.98, 0.254, 0.0841, 0.592, 0.161, 0.0852, -0.758, -0.961, -0.216, 0.183, -0.599, -0.476, 0.371, -0.805, 0.894, 0.45, 0.865, -0.71, 0.513, -0.742, -0.447, 0.408, 0.761, 0.751, -0.869, 0.91, 0.469};
    float expected[] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.98, 0.254, 0.0841, 0.592, 0.161, 0.0852, -0.758, -0.961, -0.216, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.183, -0.599, -0.476, 0.371, -0.805, 0.894, 0.45, 0.865, -0.71, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.513, -0.742, -0.447, 0.408, 0.761, 0.751, -0.869, 0.91, 0.469, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

    int size = (h + top_pad + bottom_pad) * (w + left_pad + right_pad);
    float ret[size];
    matutil_zero_pad2(inputs, h, w, channels, top_pad, bottom_pad, left_pad, right_pad, ret);
    return print_result("ZeroPad2 random 1", assert_equality(expected, ret, size));
}

int zero_pad2_random_2()
{
    int h = 5;
    int w = 5;
    int channels = 3;
    int top_pad = 2;
    int bottom_pad = 2;
    int left_pad = 2;
    int right_pad = 2;

    float inputs[] = {0.529, 0.298, -0.358, 0.351, 0.825, 0.0365, 0.433, 0.264, -0.51, -0.184, -0.678, 0.348, 0.947, -0.691, 0.249, -0.0759, 0.673, 0.541, -0.528, -0.28, 0.927, 0.0204, 0.146, 0.0279, -0.0106, -0.582, -0.149, -0.246, 0.0647, -0.628, 0.0407, -0.00785, -0.782, 0.0497, 0.0932, -0.411, -0.0637, 0.295, 0.739, -0.166, 0.698, -0.0632, -0.181, 0.174, 0.14, 0.181, -0.771, 0.869, 0.932, -0.716, -0.112, 0.317, -0.664, 0.331, -0.172, -0.108, -0.216, 0.543, 0.0999, -0.616, 0.422, 0.0567, -0.485, -0.514, 0.376, -0.295, -0.715, 0.252, -0.347, -0.954, -0.00449, 0.582, -0.738, 0.0306, -0.101};
    float expected[] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.529, 0.298, -0.358, 0.351, 0.825, 0.0365, 0.433, 0.264, -0.51, -0.184, -0.678, 0.348, 0.947, -0.691, 0.249, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.0759, 0.673, 0.541, -0.528, -0.28, 0.927, 0.0204, 0.146, 0.0279, -0.0106, -0.582, -0.149, -0.246, 0.0647, -0.628, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0407, -0.00785, -0.782, 0.0497, 0.0932, -0.411, -0.0637, 0.295, 0.739, -0.166, 0.698, -0.0632, -0.181, 0.174, 0.14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.181, -0.771, 0.869, 0.932, -0.716, -0.112, 0.317, -0.664, 0.331, -0.172, -0.108, -0.216, 0.543, 0.0999, -0.616, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.422, 0.0567, -0.485, -0.514, 0.376, -0.295, -0.715, 0.252, -0.347, -0.954, -0.00449, 0.582, -0.738, 0.0306, -0.101, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

    int size = (h + top_pad + bottom_pad) * (w + left_pad + right_pad);
    float ret[size];
    matutil_zero_pad2(inputs, h, w, channels, top_pad, bottom_pad, left_pad, right_pad, ret);
    return print_result("ZeroPad2 random 2", assert_equality(expected, ret, size));
}

void test_zero_pad2(int *correct_cases, int *total_cases)
{
    *correct_cases += zero_pad2_random_1();
    *total_cases += 1;

    *correct_cases += zero_pad2_random_2();
    *total_cases += 1;
}