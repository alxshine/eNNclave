\newcommand{\mnistgpusplita}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.632790);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.6327897045706132) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.632790);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.6327897045706132) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.632790);
}
\newcommand{\mnistgpusplitb}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.634381);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.634380754493218) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.634440);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.634439740911949) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.236838);
}
\newcommand{\mnistgpusplitc}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.630812);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.6308124260274974) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.630872);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.630872201455839) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.232325);
}
\newcommand{\mnistgpusplitd}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.535798);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.5357975199564105) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.545427);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.545426500434174) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.212712);
}
\newcommand{\mnistgpusplite}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.533322);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.5333223420596855) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.544027);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.544027143410684) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.211855);
}
\newcommand{\mnistgpusplitf}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.534320);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.534320154006104) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.543739);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.543738613821045) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.206636);
}
\newcommand{\mnistgpusplitg}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.532298);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.5322978822783533) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.545020);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.545020333417751) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.206710);
}
\newcommand{\mnistgpusplith}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.523127);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.5231274255444136) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.600455);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 2.600454832352596) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.252209);
}
\newcommand{\mnistgpuspliti}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -1.584124);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -1.5841235152926967) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 1.432041);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 1.4320411065997254) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.060169);
}

\newcommand{\mnistcpusplita}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.195505);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.19550496312130378) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.195505);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.19550496312130378) rectangle (\mnistnetwidth - \mnistlayerheight - -1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.195505);
}
\newcommand{\mnistcpusplitb}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.367924);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.36792382369611415) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.357131);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.35713112011995085) rectangle (\mnistnetwidth - \mnistlayerheight - 0*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.997536);
}
\newcommand{\mnistcpusplitc}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.390812);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.39081162326349694) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.378271);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.3782705897174183) rectangle (\mnistnetwidth - \mnistlayerheight - 1*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.993326);
}
\newcommand{\mnistcpusplitd}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.522337);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.522337107568533) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 0.284189);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0.28418914110630766) rectangle (\mnistnetwidth - \mnistlayerheight - 2*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 2.999173);
}
\newcommand{\mnistcpusplite}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.548932);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.5489315661680516) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 0.308746);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0.3087458424741951) rectangle (\mnistnetwidth - \mnistlayerheight - 3*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.004663);
}
\newcommand{\mnistcpusplitf}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.570045);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.5700446816230051) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 0.374471);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0.3744712238208448) rectangle (\mnistnetwidth - \mnistlayerheight - 4*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.017666);
}
\newcommand{\mnistcpusplitg}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.579915);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.5799149466408543) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 0.381958);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0.3819576378693145) rectangle (\mnistnetwidth - \mnistlayerheight - 5*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.019216);
}
\newcommand{\mnistcpusplith}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -0.797930);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -0.7979303781095799) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 1.435573);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 1.4355727465598023) rectangle (\mnistnetwidth - \mnistlayerheight - 6*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.073670);
}
\newcommand{\mnistcpuspliti}{\draw[fill=color1] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 0) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, -1.507653);
\draw[fill=color4] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, -1.5076530124601646) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 1.441691);
\draw[preaction={fill,color7}, pattern=north east lines] (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000, 1.4416908844704068) rectangle (\mnistnetwidth - \mnistlayerheight - 7*\mnistnodedistance - \mnistspacebetween/2 - 0.150000+0.300000, 3.088594);
}

\newcommand{\mniststartx}{0.000000}
\newcommand{\mnistnodedistance}{0.500000}
\newcommand{\mnistspacebetween}{0.100000}
\newcommand{\mnistlayerheight}{0.400000}

\newcommand{\mnistnetsummary}[1]{
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (0.000000,#1) {\tiny conv2d};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (0.500000,#1) {\tiny conv2d\_1};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (1.000000,#1) {\tiny max\_pooling2d};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (1.500000,#1) {\tiny flatten};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (2.000000,#1) {\tiny dropout};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (2.500000,#1) {\tiny dense};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (3.000000,#1) {\tiny dropout\_1};
\node[draw=black,minimum width=1.800000cm,minimum height=0.400000cm,rotate=-90, anchor=south west] at (3.500000,#1) {\tiny dense\_1};
}
\newcommand{\mnistxticks}{0.450000,0.950000,1.450000,1.950000,2.450000,2.950000,3.450000}
\newcommand{\mnistnetwidth}{3.900000}

\newcommand{\ymax}{7.000000}
\newcommand{\yticks}{1.452830,1.850417,2.082990,2.248004,2.375998,2.480577,2.568997,2.645591,2.713150,2.773585,3.171172,3.403745,3.568758,3.696753,3.801332,3.889752,3.966345,4.033905,4.094340,4.491926,4.724500,4.889513,5.017508,5.122087,5.210507,5.287100,5.354660,5.415094,5.812681,6.045254,6.210268,6.338262,6.442841,6.531262,6.607855,6.675415,6.735849}
\newcommand{\ylabels}[1]{
\draw (#1, 1.452830) node {\tiny $10^{-1}$};
\draw (#1, 2.773585) node {\tiny $10^{0}$};
\draw (#1, 4.094340) node {\tiny $10^{1}$};
\draw (#1, 5.415094) node {\tiny $10^{2}$};
\draw (#1, 6.735849) node {\tiny $10^{3}$};
}

